<!doctype html>
<html lang="en">

  <head>
    <!-- Required meta tags -->
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1, user-scalable=1">

    <script src="./lib/d3.min.js"></script>
    <script src="./lib/topojson.js"></script>
    <script src="./lib/jquery.min.js"></script>
    <script src="./lib/datamaps.world.min.js"></script>
    <link rel="stylesheet" type="text/css" href="./lib/bootstrap-responsive.min.css">
    <link rel="stylesheet" type="text/css" href="./lib/bootstrap.min.css">
    <!-- Own stylesheet -->
    <link rel="stylesheet" type="text/css" href="./css/styles.css">

    <title>CoronaMap</title>
  </head>
  <body>

    <main id="header">
      <h1>Welcome to assignment!</h1>
    </main>
    
    <div class="img-container"><img id="tau" alt="tau-logo" src="./img/tau_logo.png"></div>

    <div class="form-actions">
      <form name="countryform" id="countryform">
      <label for="country">Give a country:</label>
      <input type="text" name="country" id="country" placeholder="Country" 
             list="searchresults" autocomplete="off">
      <datalist id="searchresults"></datalist>
    </form>

      <form name="timeseriesForm" id="timeseriesForm">
        <button class="form-button" id="timeseries" type="button">Time series</button>
      </form>
    </div>
    
    <nav id="nav">
      <a class="nav_button" id="nav_corona">Corona</a>
      <a class="nav_button" id="nav_roadmap" href="roadmap.html">Roadmap</a> 
    </nav>

    <div class="table-wrapper-scroll-y my-custom-scrollbar" id="tablecont">
      <table class="table table-bordered table-striped mb-0" id="corona_stats">
        <thead>
          <tr>
            <th>Country</th>
            <th>Confirmed</th>
            <th>Deaths</th>
            <th>Recovered</th>
          </tr>
        </thead>
        <tbody>
        </tbody>
      </table>
    </div>

    <div id="containerofmap">  
      <div id="map-container"></div>
    </div>

    <footer>Created with Passion (-: Proudly Group 9 :-)</footer>

    <!-- Optional JavaScript -->
    <!-- jQuery first, then Popper.js, then Bootstrap JS -->
    <script src="https://code.jquery.com/jquery-3.4.1.slim.min.js"
            integrity="sha384-J6qa4849blE2+poT4WnyKhv5vZF5SrPo0iEjwBvKU7imGFAV0wwj1yYfoRSJoZ+n"
            crossorigin="anonymous">
    </script>
    <script src="https://cdn.jsdelivr.net/npm/popper.js@1.16.0/dist/umd/popper.min.js"
            integrity="sha384-Q6E9RHvbIyZFJoft+2mJbHaEWldlvI9IOYy5n3zV9zzTtmI3UksdQRVvoxMfooAo"
            crossorigin="anonymous">
    </script>
    <script src="https://stackpath.bootstrapcdn.com/bootstrap/4.4.1/js/bootstrap.min.js"
            integrity="sha384-wfSDF2E50Y2D1uUdj0O3uMBJnjuUD4Ih7YwaYd1iqfktj0Uod8GCExl3Og8ifwB6"
            crossorigin="anonymous">
    </script>
    <!-- Own Javascript -->
    <script src="./js/config.js"></script>
    <script src="./js/index.js"></script>
    <script src="./js/table.js"></script>
	<script src="./js/datamapping.js"></script>
  <script src="./js/neighbours.js"></script>
  <script src="./js/timeseries.js"></script>

    <script>
      
      let codeMap, caseMap, neighMap, timeMap;

        (async () => {
            const countries = await getJSON('https://tie-lukioplus.rd.tuni.fi/corona/api/countries');
            codeMap = countryCodeMap(countries, INITIAL_CODES);
            fillDataList(codeMap);
			
			const neighboursMapped = await getJSON('https://tie-lukioplus.rd.tuni.fi/corona/api/neighbours');
			neighMap = mapNeighbours(neighboursMapped);
			console.log(neighboursMapped);
            const cases = await getJSON('https://tie-lukioplus.rd.tuni.fi/corona/api/corona');
            caseMap = mapCasesWithCountrycodes(cases, codeMap);
			initialFills(caseMap);

            const timeseries = await getJSON('https://tie-lukioplus.rd.tuni.fi/corona/api/corona/timeseries/');
            timeMap = mapTimeseries(timeseries, codeMap);

            document.getElementById('country').addEventListener('input', inputHandler);
            document.getElementById('countryform').addEventListener('submit', (e) => e.preventDefault());
        })();

    </script>
  </body>

</html>
